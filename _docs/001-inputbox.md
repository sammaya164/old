---
title: "InputBox"
permalink: /inputbox/
excerpt: "VBScriptの標準的な入力機能としてInputBox関数がある"
last_modified_at: 2021-10-30T00:00:00-02:00
categories: "基本"
---

VBScriptの標準的な入力機能としてInputBox関数がある。

InputBox関数の引数と戻り値:

|引数|説明|必須/省略可|
|---|---|---|
|第1引数|メッセージ|必須|
|第2引数|タイトル|省略可|
|第3引数|デフォルトの入力値|省略可|
|第4引数|水平位置|省略可|
|第5引数|垂直位置|省略可|
|第6引数|ヘルプファイル|省略可|
|第7引数|コンテキスト|省略可|
|戻り値|入力値|-|

InputBox関数を使って入力値を取得するには次のように書く。

```vb
val = InputBox("値を入力して下さい")
```

数字を入力しても、取得した値(上記コードのval)は文字列として扱われる。
計算に使う場合はCLngやCDbl関数を使って数値に変換すること。
さもないと1+1=11のような結果を得てしまう。(+は足し算だけでなく文字列の結合にも使える)

キャンセルボタンが押された場合、戻り値はEmptyになる。
なおVBAではEmptyの代わりに長さ0の文字列が返ってくる。

スクリプトの例: 電卓

```vb
Dim tmp
'デフォルトの式を代入
tmp = "1+1"
Do
    tmp = InputBox("式を入力してください", "電卓", tmp)
    'キャンセルボタンが押された場合はループを抜ける
    If IsEmpty(tmp) then Exit Do
    MsgBox tmp & "=" & Eval(tmp),, "電卓"
Loop
```
